<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>실종 아이 등록 - Bootstrap</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">
    <link rel="stylesheet" th:href="@{/css/member/register.css}">
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <link rel="stylesheet" href="/css/summernote/summernote-lite.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
    <script src="/js/summernote/summernote-lite.js"></script>
    <script src="/js/summernote/lang/summernote-ko-KR.js"></script>
</head>
<script>
    window.onload = function() {
        // 파일 입력 필드와 테이블 엘리먼트를 가져옵니다.
        const fileInput = document.getElementById("file");
        const selectedFilesTable = document.getElementById("selectedFilesTable");
        const previewImagesDiv = document.getElementById("previewImages");

        // 파일이 선택되었을 때 이벤트를 처리합니다.
        // 파일이 선택되었을 때 이벤트를 처리합니다.
        fileInput.addEventListener("change", function() {
            const selectedFiles = fileInput.files;
            const tbody = selectedFilesTable.querySelector("tbody");

            // 선택한 파일과 이미지를 테이블에 추가합니다.
            tbody.innerHTML = ""; // 기존 내용을 지우고 다시 추가
            for (let i = 0; i < selectedFiles.length; i++) {
                const fileName = selectedFiles[i].name;
                const fileImage = createFileImageElement(selectedFiles[i]);
                const row = document.createElement("tr");
                const cellFileImage = document.createElement("td");
                const cellFileName = document.createElement("td");

                cellFileName.textContent = fileName;
                cellFileImage.appendChild(fileImage);

                row.appendChild(cellFileImage);
                row.appendChild(cellFileName);
                tbody.appendChild(row);
            }
        });

        function createFileImageElement(file) {
            const image = document.createElement("img");
            image.src = URL.createObjectURL(file); // 이미지 미리보기 생성
            image.width = 30; // 이미지 가로 크기 설정 (조절 가능)

            return image;
        }

        $('#summernote').summernote({
            height: 400,                 // 에디터 높이
            minHeight: 400,             // 최소 높이
            maxHeight: null,             // 최대 높이
            focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
            lang: "ko-KR",					// 한글 설정
            placeholder: '최대 2048자까지 쓸 수 있습니다'	//placeholder 설정
            callbacks: {
                onImageUpload: function(files) {
                    // 이미지 업로드 콜백 함수
                    uploadImage(files[0]);
                }
            }
        });

        // 서머노트 리셋
        $('#summernote').summernote('reset');
        // 마지막으로 한 행동 취소 ( 뒤로가기 )
        $('#summernote').summernote('undo');
        // 앞으로가기
        $('#summernote').summernote('redo');

    };
</script>

<body class="fade">
<div class="container">
    <div class="input-form-backgroud row">
        <div class="input-form col-md-12 mx-auto">
            <h4 class="mb-3">실종 아이 등록</h4>
            <br>
            <form class="registerForm" method="post" enctype="multipart/form-data">
                <div class="mb-3">
                    <label for="uid">제목</label>
                    <input type="text" class="form-control" name="uid" id="uid" placeholder="" required/>
                    <div class="invalid-feedback">
                    </div>
                </div>
                <label for="file" >썸네일</label>
                <div style="max-height: 100px;overflow-y: auto;">
                <table id="selectedFilesTable">
                    <thead>
                    <tr>
                        <th></th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
                </div>
                <input type="file" class="form-control" name="file" id="file" placeholder="" required style="display: none"/>
                <br>
                <label>내용</label>
                <textarea id="summernote" name="editordata"></textarea>
                <br>
                <div class="mb-3">
                    <label>실종 아이 이름</label>
                    <input type="text" class="form-control" name="p_name" placeholder="" required/>
                    <div class="invalid-feedback">
                    </div>
                </div>
                <div class="mb-3">
                    <label>종류</label>
                    <input type="text" class="form-control" name="p_cate" placeholder="강아지, 고양이, 기타 해당하는 종류를 적어주세요" required/>
                    <div class="invalid-feedback">
                    </div>
                </div>
                <div class="mb-3">
                    <label>품종</label>
                    <input type="text" class="form-control" name="p_type" placeholder="" required/>
                    <div class="invalid-feedback">
                    </div>
                </div>
                <button class="btn primary-btn btn-lg btn-block" type="submit">글 올리기</button>
            </form>
        </div>
    </div>
    <footer class="my-3 text-center text-small">
        <p class="mb-1">&copy; 2023 GaePan</p>
    </footer>
</div>
<script th:src="@{/js/member/validation.js}"></script>
<script th:src="@{/js/member/register.js}"></script>
<script th:src="@{//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js}"></script>
<script th:src="@{/js/member/zipcode.js}"></script>
</body>
</html>